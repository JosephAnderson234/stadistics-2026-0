---
title: "T1"
format: html
editor: visual
---

## Tarea 1

Loading utils:

```{r}
library(readr)
library(plyr)
library(dplyr)
library(tidyr)
library(tidyverse)
library(ggplot2)
library(stringr)
```

## Loading data

```{r}
DC <- read_csv("C19.csv")
DD <- read.csv("Demo.csv")

DC
DD


sum(is.na(DC))
sum(is.na(DD))

sum(complete.cases(DC))
sum(complete.cases(DD))
```

![](images/clipboard-1762445047.png)

```{r}
porc_na_DC <- sum(is.na(DC)) / (nrow(DC) * ncol(DC)) * 100
round(porc_na_DC, 2)
porc_na_DD <- sum(is.na(DD)) / (nrow(DD) * ncol(DD)) * 100
round(porc_na_DD, 2)
porc_elim_DC <- (1 - sum(complete.cases(DC)) / nrow(DC)) * 100
round(porc_elim_DC, 2)
porc_elim_DD <- (1 - sum(complete.cases(DD)) / nrow(DD)) * 100
round(porc_elim_DD, 2)

```

![](images/clipboard-322295896.png)

```{r}
sum(complete.cases(DC))
sum(complete.cases(DD))
names(which.min(colSums(!is.na(DC))))
names(which.min(colSums(!is.na(DD))))



```

![](images/clipboard-925049273.png)

![](images/clipboard-524626919.png)

```{r}
length(unique(DC$Pais))
length(unique(DC$Provincia))

DC %>%
  filter(is.na(Provincia)) %>%
  summarise(n = n_distinct(Pais)) %>%
  pull(n)
DC %>%
  filter(!is.na(Provincia)) %>%
  summarise(n = n_distinct(Pais)) %>%
  pull(n)
DC %>%
  filter(Pais == "United Kingdom") %>%
  summarise(n = length(unique(Provincia))) %>%
  pull(n)

```

![](images/clipboard-4132542923.png)

![](images/clipboard-2335127599.png)

![](images/clipboard-3477811988.png)

![](images/clipboard-2154381043.png)

```{r}
DC %>% 
  filter(Pais == "United Kingdom") %>%
  group_by(Fecha, Pais) %>%
  summarise(
    Contagiados = sum(Contagiados)
    , Muertos = sum(Muertos)
    , Recuperados = sum(Recuperados)
  ) -> DFU
DFU$ContDia <- diff(c(0, DFU$Contagiados))

fila_max <- DFU[which.max(DFU$ContDia), ]
fila_max
```

![](images/clipboard-1650378763.png)

![](images/clipboard-814151816.png)

```{r}
DFU_pos <- DFU %>% filter(ContDia > 0)
round(min(DFU_pos$ContDia), 2)
round(median(DFU_pos$ContDia), 2)
round(mean(DFU_pos$ContDia), 2)
round(max(DFU_pos$ContDia), 2)
round(sd(DFU_pos$ContDia), 2)
round(diff(range(DFU_pos$ContDia)), 2)
round(IQR(DFU_pos$ContDia), 2)
round(sd(DFU_pos$ContDia) / mean(DFU_pos$ContDia), 2)

```

![](images/clipboard-1225435384.png)

```{r}
DC %>% filter(Fecha == max(Fecha)) -> DF

Mort <- DF$Muertos / DF$Contagiados
Trop <- (-23 <= DF$Latitud) & (DF$Latitud <= 23)

# identificar el outlier usando el criterio del boxplot
out <- boxplot.stats(Mort)$out

# eliminarlo
Mort2 <- Mort[!Mort %in% out]
Trop2 <- Trop[!Mort %in% out]

boxplot(Mort2 ~ Trop2)
```

![](images/clipboard-1676417722.png)

```{r}
DFU <- DFU %>%
  mutate(
    TMA = (Muertos / Contagiados) * 100
  )

plot(DFU$Fecha, DFU$TMA, type = "l")

```

![](images/clipboard-312061862.png)

```{r}
breaks <- seq(0, 10000, by = 1000)
media <- mean(DFU$ContDia, na.rm = TRUE)
mediana <- median(DFU$ContDia, na.rm = TRUE)
media
mediana
hist(
  DFU$ContDia,
  breaks = breaks,
  xlim = c(0, 10000),
  main = "Histograma de contagios diarios (United Kingdom)",
  xlab = "Contagios diarios (ContDia)",
  ylab = "Frecuencia"
)

abline(v = media, lwd = 2, lty = 2)    # media
abline(v = mediana, lwd = 2, lty = 3)  # mediana


```

```{r}
DC %>% filter(Fecha == max(Fecha)) -> DZ
DX <- left_join(DZ,DD)
DX$Mort <- DX$Muertos/DX$Contagiados
DX <- DX[!is.na(DX$Mort),]
```

![](images/clipboard-4292704659.png)

```{r}
Trop <- (-23 <= DX$Latitud) & (DX$Latitud <= 23)
plot(   DX$Edad , DX$Fertilidad , cex=log10(DX$Contagiados) , pch = 21 , col= rgb(0,0,1,0.1) , bg = rgb(Trop,0,0,DX$Mort) , bty = "n" , xlab = "mediana de la edad" , ylab = "fertilidad promedio" )
```
